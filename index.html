<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<title>Bazar List</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
 
<!-- üî• Font Awesome Offline CSS -->
<link rel="stylesheet" href="assets/fontawesome/css/all.min.css">

<style>
  :root{
    --bg:#ffffff;
    --card:#eff2eb;
    --text:#1a1a1a;
    --row:#ffffff00;  /* Mobile row semi-transparent */
  }
.dark{
  --bg:#0f172a;
  --card:#162465;
  --text:#ffffff;
  --row:#1f293300;
}

body{
  margin:0;
  font-family:Arial, sans-serif;
  background:var(--bg);
  color:var(--text);
}

.container{
  max-width:900px;
  margin:16px auto;
  background:var(--card);
  padding:24px 20px;
  border-radius:16px;
}

h2{text-align:center;margin-top:0;}




button {
  padding: 8px 12px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-weight: bold;
  background: #6ebd56; /* normal color, hover/change ‡¶®‡ßá‡¶á */
  color: white;
  
  transition: transform 0.1s ease, box-shadow 0.1s ease; /* smooth press effect */
  position: relative;
}

/* click (press) effect */
button:active {
  transform: translateY(2px); /* ‡¶®‡¶ø‡¶ö‡ßá ‡¶¨‡¶∏‡¶æ */
  box-shadow: 0 3px 0 #3d8430, 0 3px 5px rgba(0,0,0,0.2); /* shadow adjust */
}



.add-btn{background:#ffb300;}
.save{background:#2563eb;color:#fff;}
.wa{background:#22c55e;color:#fff;}
.clear{background:#dc2626;color:#fff;}
.edit{background:#fde047;}
.del{background:#ef4444;color:#fff;}
.move{background:lab(99.32% -3.89 5.62);}

input{
  padding:10px;
  width:100%;
  box-sizing:border-box;
  border-radius:8px;
  border:1px solid #ccc;
  font-size:15px;
}

/* ===== Add Item inputs ===== */
.add-row{
  display:grid;
  grid-template-columns:3fr 1.5fr 1.2fr;
  gap:12px;
  margin:18px 0;
}

.add-row input{
  height:48px;
  font-size:16px;
}

/* ===== List ===== */
.list-header,.list-row{
  display:grid;
  grid-template-columns:35px 2.3fr .9fr .9fr 200px;
  gap:8px;
  align-items:center;
}

.list-header{font-weight:bold;}

.list-row{
  background:var(--row);
  padding:8px;
  border-radius:10px;
  margin-top:8px;
}

.actions{
  display:flex;
  gap:6px;
}

/* ===== Mobile label ===== */
.mobile-label{
  display:none;
  font-size:13px;
  font-weight:bold;
  margin-bottom:4px;
  opacity:.8;
}

.total{
  text-align:center;
  font-weight:bold;
  margin:16px 0;
}


/* ===== Action Buttons Icons ===== */
.actions{
  display:flex;
  gap:6px;
}

.actions button{
  background:none;
  border:none;
  cursor:pointer;
  padding:6px;
}

.actions i{
  font-size:18px;
  color:#444; /* ‚òÄÔ∏è Day mode */
}

/* üåô Dark mode ‚Üí icons white */
body.dark .actions i{
  color:#ffffff;
}

/* Hover effect (both mode) */
.actions button:hover i{
  color:#e53935;
}

body.dark .actions button:hover i{
  color:#facc15; /* yellow hover in dark */
}


.add-btn i{
  margin-right:6px;
}

.save{background:#2563eb;}
.wa{background:#22c55e;}
.clear{background:#dc2626;}

/* Dark Mode Toggle Button */
.dark-btn{
  padding:8px 14px;
  border:none;
  border-radius:10px;
  cursor:pointer;
  font-weight:bold;
  color:#fff; /* Light mode default text */
  display:inline-flex;
  align-items:center;
  gap:6px;

  background:linear-gradient(135deg, #1e3a8a, #020617);
  transition:all .2s ease;
}

/* Dark mode gradient */
body.dark .dark-btn{
  background:linear-gradient(135deg, #fbbf24, #f97316);
  /* text color handled by JS ‚Üí no need to change here */
}


/* ===== Mobile ===== */
@media(max-width:600px){

   :root{
    --bg:#ffffff;
    --card:#eff2eb;
    --text:#1a1a1a;
    --row:#ffffffde;  /* Mobile row semi-transparent */
  }

  .dark{
  --bg:#0f172a;
  --card:#162465;
  --text:#ffffff;
  --row:#c6c6c665;
}

  .add-row{
    grid-template-columns:1fr;
    row-gap:12px;
  }

  .list-header{
    display:none;
  }

  .list-row{
    grid-template-columns:1fr;
    gap:10px;
  }

  .mobile-label{
    display:block;
  }

  .actions{
    justify-content:space-between;
  }
}
</style>
</head>

<body>
<div class="container">

<h2>üõí ‡¶¨‡¶æ‡¶ú‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü</h2>

<button class="dark-btn" id="darkModeBtn">
  <i class="fa-solid fa-moon"></i>
  <span class="btn-text">Dark Mood</span>
</button>

<!-- Add Item -->
<div class="add-row">
  <input id="itemName" placeholder="‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ">
  <input id="itemQty" placeholder="‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶® (KG)">
  <input id="itemPrice" type="number" placeholder="‡¶¶‡¶æ‡¶Æ (‡ß≥)">
</div>

<button class="add-btn" onclick="addItem()">
  <i class="fa-solid fa-plus"></i> Add Item
</button>

<div class="list-header">
  <div>‡¶®‡¶Ç</div>
  <div>‡¶®‡¶æ‡¶Æ</div>
  <div>‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶®</div>
  <div>‡¶¶‡¶æ‡¶Æ</div>
  <div></div>
</div>

<div id="list"></div>

<div class="total">‡¶Æ‡ßã‡¶ü: <span id="total">0</span> ‡¶ü‡¶æ‡¶ï‡¶æ</div>

<button class="save" onclick="saveTxt()">
  <i class="fa-solid fa-floppy-disk"></i> Save TXT
</button>

<button class="wa" onclick="sendWhatsApp()">
  <i class="fa-brands fa-whatsapp"></i> WhatsApp
</button>

<button class="clear" onclick="clearAll()">
  <i class="fa-solid fa-trash"></i> Clear
</button>

</div>



<!-- Custom Fancy Alert -->
<div id="custom-alert" style="
  display:none;
  position:fixed;
  top:20px;
  left:50%;
  transform:translateX(-50%);
  background:#e53935;      /* Alert background color */
  color:white;             /* Text color */
  padding:10px 20px;
  border-radius:5px;
  box-shadow:0 2px 10px rgba(0,0,0,0.3);
  font-family:sans-serif;
  z-index:1000;
  font-size:16px;
">
  ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡¶®!
</div>

<!-- Custom Fancy confirmation -->
<div id="custom-confirm" style="
  display:none;
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%, -50%);
  background:white;      /* light mode background */
  border-radius:10px;
  padding:20px;
  box-shadow:0 4px 20px rgba(0,0,0,0.4);
  z-index:1000;
  font-family:sans-serif;
  color:black;           /* default text color */
">
  <p id="confirm-msg" style="margin-bottom:20px;">‡¶∏‡¶¨ ‡¶Æ‡ßÅ‡¶õ‡¶¨‡ßá‡¶®?</p>
  <button id="confirm-ok" style="background:#e53935;color:white;padding:5px 15px;border:none;border-radius:5px;margin-right:10px;">‡¶π‡ßç‡¶Ø‡¶æ‡¶Å</button>
  <button id="confirm-cancel" style="padding:5px 15px;border:none;border-radius:5px;">‡¶®‡¶æ</button>
</div>






<script>
let items = JSON.parse(localStorage.getItem("bazar_v8")) || [];
let dark = localStorage.getItem("dark_v8")==="true";
if(dark) document.body.classList.add("dark");



const darkBtn = document.getElementById("darkModeBtn");

darkBtn.addEventListener("click", () => {
  document.body.classList.toggle("dark"); // dark mode toggle

  const textSpan = darkBtn.querySelector(".btn-text");

  if(document.body.classList.contains("dark")) {
    textSpan.textContent = "Day Mood"; // Dark mode ON ‚Üí show "Day Mood"
  } else {
    textSpan.textContent = "Dark Mood"; // Light mode ‚Üí show "Dark Mood"
  }
});







//‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶Ü‡¶≤‡¶æ‡¶∞‡ßç‡¶ü ‡¶Æ‡¶æ‡¶∏‡ßá‡¶ú 

function showAlert(message, duration=2000) {
  const alertBox = document.getElementById("custom-alert");
  alertBox.textContent = message;    // Alert message set
  alertBox.style.display = "block";  // Show alert

  // Automatically hide after duration
  setTimeout(() => {
    alertBox.style.display = "none";
  }, duration);
}
//‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ ‡¶Æ‡¶æ‡¶∏‡ßá‡¶ú 

function showConfirm(message, onOk) {
  const confirmBox = document.getElementById("custom-confirm");
  const msg = document.getElementById("confirm-msg");
  const okBtn = document.getElementById("confirm-ok");
  const cancelBtn = document.getElementById("confirm-cancel");

  msg.textContent = message;

  // Dark mode detect
  if(document.body.classList.contains("dark")) {
    confirmBox.style.background = "#2a2a2a";  // dark background
    confirmBox.style.color = "#fff";          // light text
    okBtn.style.background = "#e53935";
    okBtn.style.color = "#fff";
    cancelBtn.style.background = "#444";
    cancelBtn.style.color = "#fff";
  } else {
    confirmBox.style.background = "white";
    confirmBox.style.color = "black";
    okBtn.style.background = "#e53935";
    okBtn.style.color = "white";
    cancelBtn.style.background = "#ddd";
    cancelBtn.style.color = "black";
  }

  confirmBox.style.display = "block";

  // Remove previous listeners
  okBtn.onclick = () => {
    confirmBox.style.display = "none";
    onOk();
  };
  cancelBtn.onclick = () => {
    confirmBox.style.display = "none";
  };
}




function addItem(){
  if(!itemName.value.trim()) return showAlert("‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡¶®");
  items.push({
    name:itemName.value,
    qty:itemQty.value,
    price:Number(itemPrice.value)
  });
  itemName.value=itemQty.value=itemPrice.value="";
  render();
}

function render(){
  list.innerHTML="";
  let total=0;

  items.forEach((it,i)=>{
    total+=it.price;
    const row=document.createElement("div");
    row.className="list-row";
    row.innerHTML=`
      <div># ${i+1}</div>

      <div>
        <span class="mobile-label">‡¶®‡¶æ‡¶Æ</span>
        <input value="${it.name}" disabled>
      </div>

      <div>
        <span class="mobile-label">‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶® (KG)</span>
        <input value="${it.qty}" disabled>
      </div>

      <div>
        <span class="mobile-label">‡¶¶‡¶æ‡¶Æ (‡ß≥)</span>
        <input type="number" value="${it.price}" disabled>
      </div>

      <div class="actions">
  <button class="move" onclick="moveItem(${i},-1)">
    <i class="fa-solid fa-chevron-up"></i>
  </button>

  <button class="move" onclick="moveItem(${i},1)">
    <i class="fa-solid fa-chevron-down"></i>
  </button>

  <button class="edit" onclick="editRow(${i},this)">
    <i class="fa-solid fa-pen-to-square"></i>
  </button>

  <button class="del" onclick="deleteItem(${i})">
    <i class="fa-solid fa-xmark"></i>
  </button>
</div>
    `;
    list.appendChild(row);
  });

  totalEl.innerText=total;
  localStorage.setItem("bazar_v8",JSON.stringify(items));
}

function moveItem(i,dir){
  const n=i+dir;
  if(n<0||n>=items.length) return;
  [items[i],items[n]]=[items[n],items[i]];
  render();
}

function editRow(i, btn) {
  const row = btn.closest(".list-row");
  const inputs = row.querySelectorAll("input");
  const icon = btn.querySelector("i");

  const isEditing = btn.dataset.editing === "true";

  if (!isEditing) {
    // Enable editing
    inputs.forEach(input => input.disabled = false);
    btn.dataset.editing = "true";
    icon.classList.remove("fa-pen-to-square");
    icon.classList.add("fa-check");
  } else {
    // Save changes
    items[i] = {
      name: inputs[0].value.trim(),
      qty: inputs[1].value.trim(), // optional: convert to number if needed
      price: Number(inputs[2].value) || 0
    };
    btn.dataset.editing = "false";
    icon.classList.remove("fa-check");
    icon.classList.add("fa-pen-to-square");
    inputs.forEach(input => input.disabled = true);

    render();
  }
}

function deleteItem(i){
  items.splice(i,1);
  render();
}

function toggleDark(){
  document.body.classList.toggle("dark");

  const icon = document.getElementById("themeIcon");
  const isDark = document.body.classList.contains("dark");

  icon.className = isDark
    ? "fa-solid fa-sun"
    : "fa-solid fa-moon";

  localStorage.setItem("dark_v8", isDark);
}


function isBanglaNumber(qty) {
  return /^[‡ß¶-‡ßØ]+$/.test(qty); // ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ
}

function isEnglishNumber(qty) {
  return /^[0-9]+$/.test(qty); // ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ
}


function getText(){
  // ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ date
  const today = new Date();
  const dd = String(today.getDate()).padStart(2,'0');
  const mm = String(today.getMonth() + 1).padStart(2,'0'); // ‡¶Æ‡¶æ‡¶∏ 0+1
  const yyyy = today.getFullYear();
  const dateStr = `${dd}/${mm}/${yyyy}`; // DD/MM/YYYY

  // ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶§‡ßá date line
  let t = `Date: ${dateStr}\r\n\r\n`; // \r\n use ‡¶ï‡¶∞‡¶≤‡ßá Windows Notepad ‡¶è‡¶ì ‡¶†‡¶ø‡¶ï ‡¶¶‡ßá‡¶ñ‡¶æ‡¶Ø‡¶º
  let total = 0;

  items.forEach((i, n) => {
    total += i.price;

    let qtyText = "N/A";

    if (i.qty !== 0 && i.qty !== "" && i.qty != null) {
      // ‡¶Ø‡¶¶‡¶ø pure number ‡¶π‡ßü
      if (isEnglishNumber(i.qty) || isBanglaNumber(i.qty)) {
        qtyText = `${i.qty} ‡¶ï‡ßá‡¶ú‡¶ø`;
      } 
      // ‡¶Ø‡¶¶‡¶ø number + text ‡¶¨‡¶æ pure text ‡¶π‡ßü
      else {
        qtyText = i.qty;
      }
    }

    t += `${n+1}. ${i.name} - ${qtyText} - ${i.price} ‡¶ü‡¶æ‡¶ï‡¶æ\r\n`;
  });

  t += `\r\n‡¶Æ‡ßã‡¶ü: ${total} ‡¶ü‡¶æ‡¶ï‡¶æ`;

  return t;
}

function saveTxt(){
  const today = new Date();
  const yyyy = today.getFullYear();
  const mm = String(today.getMonth() + 1).padStart(2, '0');
  const dd = String(today.getDate()).padStart(2, '0');

  const dateFile = `${yyyy}-${mm}-${dd}`; // file name ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

  // Blob ‡¶§‡ßà‡¶∞‡¶ø
  const b = new Blob([getText()], {type: "text/plain;charset=utf-8"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(b);
  a.download = `BazarList_${dateFile}.txt`;
  a.click();
}

function sendWhatsApp(){
  window.open("https://wa.me/?text=" + encodeURIComponent(getText()));
}


function clearAll() {
  showConfirm("‡¶∏‡¶¨ ‡¶Æ‡ßÅ‡¶õ‡¶¨‡ßá‡¶®?", () => {
    items = [];
    localStorage.removeItem("bazar_v8");
    render();
  });
}

const list=document.getElementById("list");
const totalEl=document.getElementById("total");
render();
</script>
</body>
</html>
